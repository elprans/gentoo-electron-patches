From 40a41f675ff41e31958e954e597c236ff5ea6f3c Mon Sep 17 00:00:00 2001
From: Elvis Pranskevichus <elvis@magic.io>
Date: Thu, 12 Dec 2019 16:39:11 -0500
Subject: [PATCH 2/2] Build fixes

---
 build/args/release.gn                         |   8 -
 build/npm.gni                                 |   1 -
 ...xtensions_for_file_system_access_api.patch |  50 -----
 .../chromium/cherry-pick-275865e8c237.patch   |  70 -------
 .../chromium/cherry-pick-2f5b8357dca2.patch   | 196 ------------------
 .../chromium/cherry-pick-47e21abe349a.patch   |  55 -----
 .../chromium/cherry-pick-8f5a08079948.patch   |  58 ------
 .../crashpad-initialize-logging.patch         |  25 ---
 ...xpose_setuseragent_on_networkcontext.patch |  12 --
 .../chromium/notification_provenance.patch    |  24 ---
 patches/config.json                           |   4 -
 ...r_enable_lto_and_build_v8_with_gn_in.patch |   3 +-
 patches/v8/cherry-pick-36abafa0a316.patch     |  20 +-
 ...tricter_checks_during_deoptimization.patch |  36 ----
 14 files changed, 3 insertions(+), 559 deletions(-)

diff --git a/build/args/release.gn b/build/args/release.gn
index e5017f6e16..59207b3890 100644
--- a/build/args/release.gn
+++ b/build/args/release.gn
@@ -1,6 +1,4 @@
 import("all.gn")
-is_component_build = false
-is_official_build = true
 
 # This may be guarded behind is_chrome_branded alongside
 # proprietary_codecs https://webrtc-review.googlesource.com/c/src/+/36321,
@@ -8,9 +6,3 @@ is_official_build = true
 # The initialization of the decoder depends on whether ffmpeg has
 # been built with H.264 support.
 rtc_use_h264 = proprietary_codecs
-
-# By default, Electron builds ffmpeg with proprietary codecs enabled. In order
-# to facilitate users who don't want to ship proprietary codecs in ffmpeg, or
-# who have an LGPL requirement to ship ffmpeg as a dynamically linked library,
-# we build ffmpeg as a shared library.
-is_component_ffmpeg = true
diff --git a/build/npm.gni b/build/npm.gni
index 1d1c944256..64a360952f 100644
--- a/build/npm.gni
+++ b/build/npm.gni
@@ -33,7 +33,6 @@ template("npm_action") {
     if (!defined(deps)) {
       deps = []
     }
-    deps += [ ":npm_pre_flight_" + target_name ]
 
     script = "//electron/build/npm-run.py"
     args = [
diff --git a/patches/chromium/add_restrictions_to_allowed_extensions_for_file_system_access_api.patch b/patches/chromium/add_restrictions_to_allowed_extensions_for_file_system_access_api.patch
index ef21a62777..a36fd1e2d6 100644
--- a/patches/chromium/add_restrictions_to_allowed_extensions_for_file_system_access_api.patch
+++ b/patches/chromium/add_restrictions_to_allowed_extensions_for_file_system_access_api.patch
@@ -217,53 +217,3 @@ index 0622d1d59317754fb0696ab4918740a434e6eaa6..10f759dca7775c189bf692f1743b196a
    extensions.push_back(extension.Substring(1));
    return true;
  }
-diff --git a/third_party/blink/web_tests/external/wpt/native-file-system/showPicker-errors.https.window.js b/third_party/blink/web_tests/external/wpt/native-file-system/showPicker-errors.https.window.js
-index e8f0d3f540485120cd15d642b1b0d33110797098..d1dabf37da8305094bf7e0bd0fea4e0200d8dd2e 100644
---- a/third_party/blink/web_tests/external/wpt/native-file-system/showPicker-errors.https.window.js
-+++ b/third_party/blink/web_tests/external/wpt/native-file-system/showPicker-errors.https.window.js
-@@ -80,9 +80,39 @@ function define_file_picker_error_tests(showPickerMethod) {
-       showPickerMethod +
-           ': MIME type can\'t have invalid characters in subtype.');
- 
--  promise_test(async t => {
--    await promise_rejects_js(t, TypeError, self[showPickerMethod]({
--                               types: [{accept: {'text/plain': ['.txt', 'txt']}}]
--                             }));
--  }, showPickerMethod + ': extension has to start with ".".');
-+  const invalid_extensions = {
-+    '.extensiontoolong': 'extension length more than 16.',
-+    '.txt.': 'extenstion ends with "."',
-+    'txt': 'extenstion does not start with "."',
-+    '.$txt' : 'illegal character "$"',
-+    '.t<xt': 'illegal character "<"',
-+    '.t/xt': 'illegal character "\"',
-+    '.\txt': 'illegal character "/"',
-+    '.txt\\': 'illegal characters "\\"',
-+    '.txt?': 'illegal character "?"',
-+    '.txt*': 'illegal character "*"',
-+    '.{txt': 'illegal character "{"',
-+    '.}txt': 'illegal character "}"',
-+    ' .txt': 'illegal whitespace at front of extension',
-+    '. txt': 'illegal whitespace in extension',
-+    '.txt ': 'illegal whitespace at end of extension',
-+    '.\u202etxt\u202e' : 'illegal RTL character',
-+    '.t\u00E6xt': 'non-ASCII character "æ"',
-+    '.קום': 'non-ASCII character "קום"',
-+    '.txt🙂': 'non-ASCII character "🙂"',
-+    '.{txt}': 'illegal characters "{" and "}"',
-+  }
-+
-+  for (const [extension, description] of Object.entries(invalid_extensions)) {
-+    define_file_picker_extension_error_test(showPickerMethod, extension, description)
-+  }
- }
-+
-+function define_file_picker_extension_error_test(showPickerMethod, extension, description) {
-+  promise_test(async t => {
-+    await promise_rejects_js(
-+      t, TypeError,
-+      self[showPickerMethod](
-+        { types: [{ accept: { 'text/plain': ['.txt', extension] } }] }));
-+  }, showPickerMethod + ': invalid extension "' + extension + '". ' + description + ".");
-+}
-\ No newline at end of file
diff --git a/patches/chromium/cherry-pick-275865e8c237.patch b/patches/chromium/cherry-pick-275865e8c237.patch
index 550a7e5860..4f5a7bc4a6 100644
--- a/patches/chromium/cherry-pick-275865e8c237.patch
+++ b/patches/chromium/cherry-pick-275865e8c237.patch
@@ -341,73 +341,3 @@ index 17801b9774813df79e4b944cb0a73535eb4c07c2..6eb2c484ddc479d9cfa566df0b103782
 +}
 +
  }  // namespace content
-diff --git a/content/public/test/browser_test_utils.cc b/content/public/test/browser_test_utils.cc
-index 47161f98b2fcdacece578cde50141860d2ab0a40..a8f988b8465c420224979d805baf454483e49134 100644
---- a/content/public/test/browser_test_utils.cc
-+++ b/content/public/test/browser_test_utils.cc
-@@ -3220,10 +3220,11 @@ void VerifyStaleContentOnFrameEviction(
- 
- #endif  // defined(USE_AURA)
- 
--ContextMenuFilter::ContextMenuFilter()
-+ContextMenuFilter::ContextMenuFilter(ShowBehavior behavior)
-     : BrowserMessageFilter(FrameMsgStart),
-       run_loop_(std::make_unique<base::RunLoop>()),
--      quit_closure_(run_loop_->QuitClosure()) {}
-+      quit_closure_(run_loop_->QuitClosure()),
-+      show_behavior_(behavior) {}
- 
- bool ContextMenuFilter::OnMessageReceived(const IPC::Message& message) {
-   DCHECK_CURRENTLY_ON(BrowserThread::IO);
-@@ -3234,6 +3235,9 @@ bool ContextMenuFilter::OnMessageReceived(const IPC::Message& message) {
-     GetUIThreadTaskRunner({})->PostTask(
-         FROM_HERE,
-         base::BindOnce(&ContextMenuFilter::OnContextMenu, this, menu_params));
-+    // Returning true here blocks the default action for this message, which
-+    // means that the menu will not be shown.
-+    return show_behavior_ == ShowBehavior::kPreventShow;
-   }
-   return false;
- }
-@@ -3244,6 +3248,12 @@ void ContextMenuFilter::Wait() {
-   run_loop_ = nullptr;
- }
- 
-+void ContextMenuFilter::Reset() {
-+  ASSERT_EQ(run_loop_, nullptr);
-+  run_loop_ = std::make_unique<base::RunLoop>();
-+  quit_closure_ = run_loop_->QuitClosure();
-+}
-+
- ContextMenuFilter::~ContextMenuFilter() = default;
- 
- void ContextMenuFilter::OnContextMenu(
-diff --git a/content/public/test/browser_test_utils.h b/content/public/test/browser_test_utils.h
-index f68d423999ff711b46b7fe9d718163158e1d5223..3568bcceee9867db634306d36e3281d32450ea0a 100644
---- a/content/public/test/browser_test_utils.h
-+++ b/content/public/test/browser_test_utils.h
-@@ -1688,10 +1688,15 @@ void VerifyStaleContentOnFrameEviction(
- // sent by the renderer.
- class ContextMenuFilter : public content::BrowserMessageFilter {
-  public:
--  ContextMenuFilter();
-+  // Whether or not the ContextMenu should be prevented from performing
-+  // its default action, preventing the context menu from showing.
-+  enum ShowBehavior { kShow, kPreventShow };
-+
-+  explicit ContextMenuFilter(ShowBehavior behavior = ShowBehavior::kShow);
- 
-   bool OnMessageReceived(const IPC::Message& message) override;
-   void Wait();
-+  void Reset();
- 
-   content::UntrustworthyContextMenuParams get_params() { return last_params_; }
- 
-@@ -1703,6 +1708,7 @@ class ContextMenuFilter : public content::BrowserMessageFilter {
-   std::unique_ptr<base::RunLoop> run_loop_;
-   base::OnceClosure quit_closure_;
-   content::UntrustworthyContextMenuParams last_params_;
-+  const ShowBehavior show_behavior_;
- 
-   DISALLOW_COPY_AND_ASSIGN(ContextMenuFilter);
- };
diff --git a/patches/chromium/cherry-pick-2f5b8357dca2.patch b/patches/chromium/cherry-pick-2f5b8357dca2.patch
index 40a02a7af4..0c3f748c9c 100644
--- a/patches/chromium/cherry-pick-2f5b8357dca2.patch
+++ b/patches/chromium/cherry-pick-2f5b8357dca2.patch
@@ -132,199 +132,3 @@ index 96b6fa030c2a36ab5c4217ad19f0bfe4d5212bb8..3abd9933ab325bda6cb486a41fd6c8b2
      } else {
        [ret addObjectsFromArray:@[ NSAccessibilityIndexAttribute ]];
      }
-diff --git a/content/test/data/accessibility/aria/aria-level-expected-mac.txt b/content/test/data/accessibility/aria/aria-level-expected-mac.txt
-index 2977dc82f7c894b8496158fb51dc2665939d0d9d..19b7c2b3f131a41f9e49dc4a8db875efe53e3cdb 100644
---- a/content/test/data/accessibility/aria/aria-level-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-level-expected-mac.txt
-@@ -14,21 +14,21 @@ AXWebArea
- ++AXHeading AXTitle='Level 5' AXValue=5
- ++++AXStaticText AXValue='Level 5'
- ++AXOutline
--++++AXRow AXSubrole=AXOutlineRow AXDisclosing=1 AXDisclosureLevel=0 AXTitle='Tree item at level 1'
-+++++AXRow AXSubrole=AXOutlineRow AXDisclosing=1 AXDisclosureLevel=0 AXIndex=0 AXTitle='Tree item at level 1'
- ++++++AXStaticText AXValue='Tree item at level 1'
- ++++++AXGroup
--++++++++AXRow AXSubrole=AXOutlineRow AXDisclosing=0 AXDisclosureLevel=1 AXTitle='Tree item at level 2'
-+++++++++AXRow AXSubrole=AXOutlineRow AXDisclosing=0 AXDisclosureLevel=1 AXIndex=1 AXTitle='Tree item at level 2'
- ++++++++++AXStaticText AXValue='Tree item at level 2'
--++++AXRow AXSubrole=AXOutlineRow AXDisclosing=0 AXDisclosureLevel=2 AXTitle='Tree item at level 3'
-+++++AXRow AXSubrole=AXOutlineRow AXDisclosing=0 AXDisclosureLevel=2 AXIndex=2 AXTitle='Tree item at level 3'
- ++++++AXStaticText AXValue='Tree item at level 3'
- ++AXTable
--++++AXRow AXDisclosureLevel=0
-+++++AXRow AXDisclosureLevel=0 AXIndex=0
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 1'
--++++AXRow AXDisclosureLevel=1
-+++++AXRow AXDisclosureLevel=1 AXIndex=1
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 2'
--++++AXColumn
-+++++AXColumn AXIndex=0
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 1'
- ++++++AXCell
-diff --git a/content/test/data/accessibility/aria/aria-level.html b/content/test/data/accessibility/aria/aria-level.html
-index 9c499edadbfb8dfa3c07d5cf1d9e5f48349a48a5..b7aabab3a3232985c597cb2362184c0a436e8475 100644
---- a/content/test/data/accessibility/aria/aria-level.html
-+++ b/content/test/data/accessibility/aria/aria-level.html
-@@ -3,6 +3,7 @@
- @MAC-ALLOW:AXSubrole=AXOutlineRow
- @MAC-ALLOW:AXDisclosing*
- @MAC-ALLOW:AXDisclosureLevel*
-+@MAC-ALLOW:AXIndex*
- @WIN-ALLOW:level:*
- @WIN-ALLOW:EXPANDED
- @WIN-DENY:name=''
-diff --git a/content/test/data/accessibility/aria/aria-tree-discontinuous-expected-mac.txt b/content/test/data/accessibility/aria/aria-tree-discontinuous-expected-mac.txt
-index 3f2259665df8fbc291a848e5ada5ee02c37eb8cd..48afda07b5d020f0972a9aaf9ccffcfb76fd3857 100644
---- a/content/test/data/accessibility/aria/aria-tree-discontinuous-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-tree-discontinuous-expected-mac.txt
-@@ -1,7 +1,7 @@
- AXWebArea
- ++AXOutline AXARIASetSize=2
--++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXTitle='card content'
-+++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXIndex=0 AXTitle='card content'
- ++++++AXStaticText AXValue='card content'
- ++++AXGroup
--++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXTitle='card content'
-+++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXIndex=1 AXTitle='card content'
- ++++++AXStaticText AXValue='card content'
-diff --git a/content/test/data/accessibility/aria/aria-tree-discontinuous.html b/content/test/data/accessibility/aria/aria-tree-discontinuous.html
-index c0ef927e92216957f9369afedb07c068c0970025..f14ce533208511655e6c86f934661e1adec083ba 100644
---- a/content/test/data/accessibility/aria/aria-tree-discontinuous.html
-+++ b/content/test/data/accessibility/aria/aria-tree-discontinuous.html
-@@ -1,6 +1,7 @@
- <!--
- @MAC-ALLOW:AXARIASetSize
- @MAC-ALLOW:AXARIAPosInSet
-+@MAC-ALLOW:AXIndex
- @WIN-ALLOW:setsize*
- @WIN-ALLOW:posinset*
- @UIA-WIN-ALLOW:SizeOfSet*
-diff --git a/content/test/data/accessibility/aria/aria-tree-expected-mac.txt b/content/test/data/accessibility/aria/aria-tree-expected-mac.txt
-index 5d40b45374b4cc3685eff0146d34e3f814216af8..2580c407cf97626dff52f6e883b5ee8c1c753dc8 100644
---- a/content/test/data/accessibility/aria/aria-tree-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-tree-expected-mac.txt
-@@ -1,22 +1,22 @@
- AXWebArea
- ++AXOutline AXARIASetSize=2
--++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXTitle='Animals' AXValue=2
-+++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXIndex=0 AXTitle='Animals' AXValue=2
- ++++++AXLink AXDescription='Animals'
- ++++++++AXStaticText AXValue='Animals'
- ++++++AXGroup AXARIASetSize=2
--++++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXTitle='Domesticated'
-+++++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXIndex=1 AXTitle='Domesticated'
- ++++++++++AXLink AXDescription='Domesticated'
- ++++++++++++AXStaticText AXValue='Domesticated'
- ++++++++++AXGroup AXARIASetSize=2
--++++++++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXTitle='Dog' AXValue=1
-+++++++++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXIndex=2 AXTitle='Dog' AXValue=1
- ++++++++++++++AXLink AXDescription='Dog'
- ++++++++++++++++AXStaticText AXValue='Dog'
--++++++++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXTitle='Cat' AXValue=0
-+++++++++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXIndex=3 AXTitle='Cat' AXValue=0
- ++++++++++++++AXLink AXDescription='Cat'
- ++++++++++++++++AXStaticText AXValue='Cat'
--++++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXTitle='Wild'
-+++++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXIndex=4 AXTitle='Wild'
- ++++++++++AXLink AXDescription='Wild'
- ++++++++++++AXStaticText AXValue='Wild'
--++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXTitle='Plants'
-+++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXIndex=5 AXTitle='Plants'
- ++++++AXLink AXDescription='Plants'
- ++++++++AXStaticText AXValue='Plants'
-diff --git a/content/test/data/accessibility/aria/aria-tree.html b/content/test/data/accessibility/aria/aria-tree.html
-index f2974e876b83e48d277a54d2bcf92319dcc89cfe..7b984675b97b09cb629d81d6835b5616c7b8873f 100644
---- a/content/test/data/accessibility/aria/aria-tree.html
-+++ b/content/test/data/accessibility/aria/aria-tree.html
-@@ -1,4 +1,5 @@
- <!--
-+@MAC-ALLOW:AXIndex
- @MAC-ALLOW:AXARIASetSize
- @MAC-ALLOW:AXARIAPosInSet
- @WIN-ALLOW:setsize*
-diff --git a/content/test/data/accessibility/aria/aria-treegrid-expected-mac.txt b/content/test/data/accessibility/aria/aria-treegrid-expected-mac.txt
-index 3c28472ddfe697d88e3fba3fe0fcff5853e0d1d5..d4d0a70fd610994b19641ddd69a31bb56574a55e 100644
---- a/content/test/data/accessibility/aria/aria-treegrid-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-treegrid-expected-mac.txt
-@@ -1,12 +1,12 @@
- AXWebArea
- ++AXTable
--++++AXRow AXDisclosureLevel=0
-+++++AXRow AXDisclosureLevel=0 AXIndex=0
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 1'
--++++AXRow AXDisclosureLevel=1
-+++++AXRow AXDisclosureLevel=1 AXIndex=1
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 2'
--++++AXColumn
-+++++AXColumn AXIndex=0
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 1'
- ++++++AXCell
-@@ -14,10 +14,10 @@ AXWebArea
- ++++AXGroup
- ++AXTable
- ++++AXGroup
--++++++AXRow AXDisclosureLevel=0
-+++++++AXRow AXDisclosureLevel=0 AXIndex=0
- ++++++++AXCell
- ++++++++++AXStaticText AXValue='Cell at level 1'
--++++AXColumn
-+++++AXColumn AXIndex=0
- ++++++AXCell
- ++++++++AXStaticText AXValue='Cell at level 1'
- ++++AXGroup
-diff --git a/content/test/data/accessibility/aria/aria-treegrid.html b/content/test/data/accessibility/aria/aria-treegrid.html
-index f8aefe163b900596152999b845bd856b44a05df2..01b74aa99db9304248e94273bbc3d73a170d8539 100644
---- a/content/test/data/accessibility/aria/aria-treegrid.html
-+++ b/content/test/data/accessibility/aria/aria-treegrid.html
-@@ -1,5 +1,6 @@
- <!--
- @BLINK-ALLOW:hierarchicalLevel*
-+@MAC-ALLOW:AXIndex
- @MAC-ALLOW:AXRole=*
- @MAC-ALLOW:AXDisclosureLevel*
- @WIN-ALLOW:xml-roles:*
-diff --git a/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists-expected-mac.txt b/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists-expected-mac.txt
-index 0b7abc24fd7b3acec0a44244c7f975075282e887..523458d38299a7599060c1fda8a8c301acc4304f 100644
---- a/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists-expected-mac.txt
-@@ -1,17 +1,17 @@
- AXWebArea AXRoleDescription='HTML content'
- ++AXOutline AXARIASetSize=5 AXRoleDescription='outline'
- ++++AXGroup AXRoleDescription='group'
--++++++AXRow AXARIAPosInSet=2 AXARIASetSize=5 AXRoleDescription='row' AXTitle='treeitem 2 of 5, level 1'
-+++++++AXRow AXARIAPosInSet=2 AXARIASetSize=5 AXIndex=0 AXRoleDescription='row' AXTitle='treeitem 2 of 5, level 1'
- ++++++++AXStaticText AXRoleDescription='text' AXValue='treeitem 2 of 5, level 1'
- ++++AXGroup AXRoleDescription='group'
--++++++AXRow AXARIAPosInSet=3 AXARIASetSize=5 AXRoleDescription='row' AXTitle='treeitem 3 of 5, level 1'
-+++++++AXRow AXARIAPosInSet=3 AXARIASetSize=5 AXIndex=1 AXRoleDescription='row' AXTitle='treeitem 3 of 5, level 1'
- ++++++++AXStaticText AXRoleDescription='text' AXValue='treeitem 3 of 5, level 1'
- ++++AXGroup AXRoleDescription='group'
--++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXRoleDescription='row' AXTitle='treeitem 1 of 2, level 2'
-+++++++AXRow AXARIAPosInSet=1 AXARIASetSize=2 AXIndex=2 AXRoleDescription='row' AXTitle='treeitem 1 of 2, level 2'
- ++++++++AXStaticText AXRoleDescription='text' AXValue='treeitem 1 of 2, level 2'
- ++++AXGroup AXRoleDescription='group'
--++++++AXRow AXARIAPosInSet=1 AXARIASetSize=1 AXRoleDescription='row' AXTitle='treeitem 1 of 1, level 3'
-+++++++AXRow AXARIAPosInSet=1 AXARIASetSize=1 AXIndex=3 AXRoleDescription='row' AXTitle='treeitem 1 of 1, level 3'
- ++++++++AXStaticText AXRoleDescription='text' AXValue='treeitem 1 of 1, level 3'
- ++++AXGroup AXRoleDescription='group'
--++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXRoleDescription='row' AXTitle='treeitem 2 of 2, level 2'
-+++++++AXRow AXARIAPosInSet=2 AXARIASetSize=2 AXIndex=4 AXRoleDescription='row' AXTitle='treeitem 2 of 2, level 2'
- ++++++++AXStaticText AXRoleDescription='text' AXValue='treeitem 2 of 2, level 2'
-diff --git a/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists.html b/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists.html
-index f3794bbad09a43a279fef12b5bc4f63e1c70341f..8294fb11adb63a801117e4439c8b43c48dc8ce59 100644
---- a/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists.html
-+++ b/content/test/data/accessibility/aria/aria-treeitem-nested-in-lists.html
-@@ -4,6 +4,7 @@
- @MAC-ALLOW:AXARIAPosInSet*
- @MAC-DENY:AXARIASetSize=0
- @MAC-DENY:AXARIAPosInSet=0
-+@MAC-ALLOW:AXIndex
- @WIN-ALLOW:xml-roles*
- @WIN-ALLOW:level*
- @WIN-ALLOW:setsize*
diff --git a/patches/chromium/cherry-pick-47e21abe349a.patch b/patches/chromium/cherry-pick-47e21abe349a.patch
index c471a82c13..522159cdd7 100644
--- a/patches/chromium/cherry-pick-47e21abe349a.patch
+++ b/patches/chromium/cherry-pick-47e21abe349a.patch
@@ -454,61 +454,6 @@ index 68b8ccd88fb4ad6e4793a54869d5424f2a860d8a..4232959e30ab758bff58aa8e4457b6cd
    };
  }
  
-diff --git a/content/test/data/accessibility/event/aria-combo-box-focus-expected-mac.txt b/content/test/data/accessibility/event/aria-combo-box-focus-expected-mac.txt
-index ad5e2bf2c8029185c51eecc94cac1dbe7608c99e..67e07a89f77f7c61a57eb51cecea211df5227341 100644
---- a/content/test/data/accessibility/event/aria-combo-box-focus-expected-mac.txt
-+++ b/content/test/data/accessibility/event/aria-combo-box-focus-expected-mac.txt
-@@ -1,3 +1,3 @@
- AXFocusedUIElementChanged on AXStaticText AXValue="Apple not selected"
--AXSelectedTextChanged on AXStaticText AXValue="Apple not selected"
--AXSelectedTextChanged on AXWebArea
-\ No newline at end of file
-+AXSelectedTextChanged on AXStaticText AXValue="Apple not selected" AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
-diff --git a/content/test/data/accessibility/event/caret-browsing-disabled-expected-mac.txt b/content/test/data/accessibility/event/caret-browsing-disabled-expected-mac.txt
-index ec0b74d984ade9928705242f9b0682a743e20fb2..87447c5a4b14efde5b64b1d340a3fa2fb6574b80 100644
---- a/content/test/data/accessibility/event/caret-browsing-disabled-expected-mac.txt
-+++ b/content/test/data/accessibility/event/caret-browsing-disabled-expected-mac.txt
-@@ -1,5 +1,5 @@
--AXSelectedTextChanged on AXWebArea
--AXSelectedTextChanged on AXWebArea
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
- === Start Continuation ===
--AXSelectedTextChanged on AXWebArea
--AXSelectedTextChanged on AXWebArea
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-diff --git a/content/test/data/accessibility/event/caret-browsing-enabled-expected-mac.txt b/content/test/data/accessibility/event/caret-browsing-enabled-expected-mac.txt
-index ec0b74d984ade9928705242f9b0682a743e20fb2..87447c5a4b14efde5b64b1d340a3fa2fb6574b80 100644
---- a/content/test/data/accessibility/event/caret-browsing-enabled-expected-mac.txt
-+++ b/content/test/data/accessibility/event/caret-browsing-enabled-expected-mac.txt
-@@ -1,5 +1,5 @@
--AXSelectedTextChanged on AXWebArea
--AXSelectedTextChanged on AXWebArea
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
- === Start Continuation ===
--AXSelectedTextChanged on AXWebArea
--AXSelectedTextChanged on AXWebArea
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-diff --git a/content/test/data/accessibility/event/text-selection-changed-expected-mac.txt b/content/test/data/accessibility/event/text-selection-changed-expected-mac.txt
-new file mode 100644
-index 0000000000000000000000000000000000000000..9213c873393d595bba8796cdb0e2325d3ee37ee9
---- /dev/null
-+++ b/content/test/data/accessibility/event/text-selection-changed-expected-mac.txt
-@@ -0,0 +1,10 @@
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeUnknown
-+=== Start Continuation ===
-+AXFocusedUIElementChanged on AXTextField AXDescription="input" AXValue="input"
-+AXSelectedTextChanged on AXTextField AXDescription="input" AXValue="input" AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
-+=== Start Continuation ===
-+AXFocusedUIElementChanged on AXTextArea AXDescription="textarea"
-+AXSelectedTextChanged on AXTextArea AXDescription="textarea" AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
-+AXSelectedTextChanged on AXWebArea AXTextSelectionDirection=AXTextSelectionDirectionUnknown AXTextSelectionGranularity=AXTextSelectionGranularityUnknown AXTextStateChangeType=AXTextStateChangeTypeSelectionMove
 diff --git a/ui/accessibility/platform/BUILD.gn b/ui/accessibility/platform/BUILD.gn
 index 2f015b939bb6835f2ff817ce6c960157eaf32342..eafddade0f7fa8ab8d008bf4888fc9ecef85463d 100644
 --- a/ui/accessibility/platform/BUILD.gn
diff --git a/patches/chromium/cherry-pick-8f5a08079948.patch b/patches/chromium/cherry-pick-8f5a08079948.patch
index 3b84fc99ae..6d1280469c 100644
--- a/patches/chromium/cherry-pick-8f5a08079948.patch
+++ b/patches/chromium/cherry-pick-8f5a08079948.patch
@@ -55,61 +55,3 @@ index 3abd9933ab325bda6cb486a41fd6c8b246aa8e71..17aa494d6473866721a8cc5f4c5c646a
      ]];
    }
  
-diff --git a/content/test/data/accessibility/aria/aria-haspopup-expected-mac.txt b/content/test/data/accessibility/aria/aria-haspopup-expected-mac.txt
-index e988b9fe7d061fa3aa6930ababa4f32c095bd8a3..de0f31f2065490d6085027e2800706a3926bcf5b 100644
---- a/content/test/data/accessibility/aria/aria-haspopup-expected-mac.txt
-+++ b/content/test/data/accessibility/aria/aria-haspopup-expected-mac.txt
-@@ -1,10 +1,10 @@
- AXWebArea
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='menu'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='menu'
- ++AXPopUpButton
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='menu'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='listbox'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='grid'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='dialog'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='menu'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='listbox'
--++AXPopUpButton AXHasPopup=1 AXHasPopupValue='listbox'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='menu'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='listbox'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='grid'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='dialog'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='menu'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='listbox'
-+++AXPopUpButton AXHasPopup=1 AXPopupValue='listbox'
-diff --git a/content/test/data/accessibility/aria/aria-haspopup.html b/content/test/data/accessibility/aria/aria-haspopup.html
-index 026397c4e9ad805f5facfc499cc986cd0763aef3..7d982745e89b8346bf71eee90110fe6a96648629 100644
---- a/content/test/data/accessibility/aria/aria-haspopup.html
-+++ b/content/test/data/accessibility/aria/aria-haspopup.html
-@@ -3,7 +3,7 @@
- @MAC-ALLOW:AXShowMenu*
- @MAC-ALLOW:AXPress*
- @MAC-ALLOW:AXHasPopup
--@MAC-ALLOW:AXHasPopupValue
-+@MAC-ALLOW:AXPopupValue
- @WIN-ALLOW:EXPANDED*
- @WIN-ALLOW:HASPOPUP*
- @WIN-ALLOW:haspopup*
-diff --git a/content/test/data/accessibility/html/input-suggestions-source-element-expected-mac.txt b/content/test/data/accessibility/html/input-suggestions-source-element-expected-mac.txt
-index 4b0bde650deed34edead37ffabd3eda2d7a82b49..38ca751991f564f9a24ba131652014f161d4b996 100644
---- a/content/test/data/accessibility/html/input-suggestions-source-element-expected-mac.txt
-+++ b/content/test/data/accessibility/html/input-suggestions-source-element-expected-mac.txt
-@@ -1,3 +1,3 @@
- AXWebArea AXRoleDescription='HTML content'
- ++AXGroup AXRoleDescription='group'
--++++AXComboBox AXAutocompleteValue='list' AXHasPopup=1 AXHasPopupValue='listbox' AXRoleDescription='combo box'
-+++++AXComboBox AXAutocompleteValue='list' AXHasPopup=1 AXPopupValue='listbox' AXRoleDescription='combo box'
-diff --git a/content/test/data/accessibility/html/input-suggestions-source-element.html b/content/test/data/accessibility/html/input-suggestions-source-element.html
-index 039ac5855e1122b34dad0c1fae42f798791b7890..d024f17de3d3b04029c532e616140e20afa87549 100644
---- a/content/test/data/accessibility/html/input-suggestions-source-element.html
-+++ b/content/test/data/accessibility/html/input-suggestions-source-element.html
-@@ -1,7 +1,7 @@
- <!--
- @MAC-ALLOW:AXRoleDescription
- @MAC-ALLOW:AXHasPopup
--@MAC-ALLOW:AXHasPopupValue
-+@MAC-ALLOW:AXPopupValue
- @WIN-ALLOW:haspopup*
- @AURALINUX-ALLOW:haspopup*
- @AURALINUX-ALLOW:supports-autocompletion
diff --git a/patches/chromium/crashpad-initialize-logging.patch b/patches/chromium/crashpad-initialize-logging.patch
index 61b399dc61..dca0122a45 100644
--- a/patches/chromium/crashpad-initialize-logging.patch
+++ b/patches/chromium/crashpad-initialize-logging.patch
@@ -119,28 +119,3 @@ index 33649291e253a7a9bd281b892bab415ff1950b6a..a3ba9bb17e221e8330b09eae572d116b
  
    InstallCrashHandler();
    CallMetricsRecordNormalExit metrics_record_normal_exit;
-diff --git a/third_party/crashpad/crashpad/test/gtest_main.cc b/third_party/crashpad/crashpad/test/gtest_main.cc
-index 67cfa0d72d7eb469775201f3a9df906f27c302a9..c67b8e24bb940935d5da88428ed3058a135f5a57 100644
---- a/third_party/crashpad/crashpad/test/gtest_main.cc
-+++ b/third_party/crashpad/crashpad/test/gtest_main.cc
-@@ -12,6 +12,7 @@
- // See the License for the specific language governing permissions and
- // limitations under the License.
- 
-+#include "base/logging.h"
- #include "build/build_config.h"
- #include "gtest/gtest.h"
- #include "test/main_arguments.h"
-@@ -99,6 +100,12 @@ int main(int argc, char* argv[]) {
- 
- #endif  // CRASHPAD_IS_IN_CHROMIUM
- 
-+  // base::TestSuite initializes logging when using Chromium's test launcher.
-+  logging::LoggingSettings settings;
-+  settings.logging_dest =
-+      logging::LOG_TO_STDERR | logging::LOG_TO_SYSTEM_DEBUG_LOG;
-+  logging::InitLogging(settings);
-+
- #if defined(CRASHPAD_TEST_LAUNCHER_GOOGLEMOCK)
-   testing::InitGoogleMock(&argc, argv);
- #elif defined(CRASHPAD_TEST_LAUNCHER_GOOGLETEST)
diff --git a/patches/chromium/expose_setuseragent_on_networkcontext.patch b/patches/chromium/expose_setuseragent_on_networkcontext.patch
index f2cff73a31..a7ab550537 100644
--- a/patches/chromium/expose_setuseragent_on_networkcontext.patch
+++ b/patches/chromium/expose_setuseragent_on_networkcontext.patch
@@ -76,15 +76,3 @@ index e45dff2ab8abd378da7886b5becfcb673f5dc642..0f9d88529021db245fb498dfa339e532
    // Updates the Accept-Language header to be used for requests.
    SetAcceptLanguage(string new_accept_language);
  
-diff --git a/services/network/test/test_network_context.h b/services/network/test/test_network_context.h
-index 789be83b3d42d464c1ccc71bf13820187c598fcb..d0eddf77b04f41ae25400647629b4324e4060d7a 100644
---- a/services/network/test/test_network_context.h
-+++ b/services/network/test/test_network_context.h
-@@ -107,6 +107,7 @@ class TestNetworkContext : public mojom::NetworkContext {
-   void CloseIdleConnections(CloseIdleConnectionsCallback callback) override {}
-   void SetNetworkConditions(const base::UnguessableToken& throttling_profile_id,
-                             mojom::NetworkConditionsPtr conditions) override {}
-+  void SetUserAgent(const std::string& new_user_agent) override {}
-   void SetAcceptLanguage(const std::string& new_accept_language) override {}
-   void SetEnableReferrers(bool enable_referrers) override {}
- #if defined(OS_CHROMEOS)
diff --git a/patches/chromium/notification_provenance.patch b/patches/chromium/notification_provenance.patch
index c347da1264..a1fef77185 100644
--- a/patches/chromium/notification_provenance.patch
+++ b/patches/chromium/notification_provenance.patch
@@ -141,27 +141,3 @@ index ca61088079c4150fcf389504ddcf26bcf6bf69cd..d9c034c39890eef1fe3d95c6d7c0ae68
        const std::string& notification_id,
        const GURL& origin,
        const blink::PlatformNotificationData& notification_data,
-diff --git a/content/test/mock_platform_notification_service.cc b/content/test/mock_platform_notification_service.cc
-index 639a93ac8d4f295910fcfb64d69d1498c9dbbe94..25d7b29b53b426d02664bc904f1c646662d9a5d5 100644
---- a/content/test/mock_platform_notification_service.cc
-+++ b/content/test/mock_platform_notification_service.cc
-@@ -30,6 +30,7 @@ MockPlatformNotificationService::MockPlatformNotificationService(
- MockPlatformNotificationService::~MockPlatformNotificationService() = default;
- 
- void MockPlatformNotificationService::DisplayNotification(
-+    RenderProcessHost* render_process_host,
-     const std::string& notification_id,
-     const GURL& origin,
-     const blink::PlatformNotificationData& notification_data,
-diff --git a/content/test/mock_platform_notification_service.h b/content/test/mock_platform_notification_service.h
-index 6d108f9884f7e8f608b70ec33d286a06346e7456..4650a01c2d090c5957eb7a7e21f124489513142a 100644
---- a/content/test/mock_platform_notification_service.h
-+++ b/content/test/mock_platform_notification_service.h
-@@ -47,6 +47,7 @@ class MockPlatformNotificationService : public PlatformNotificationService {
- 
-   // PlatformNotificationService implementation.
-   void DisplayNotification(
-+      RenderProcessHost* render_process_host,
-       const std::string& notification_id,
-       const GURL& origin,
-       const blink::PlatformNotificationData& notification_data,
diff --git a/patches/config.json b/patches/config.json
index 2a99d01abe..635195c366 100644
--- a/patches/config.json
+++ b/patches/config.json
@@ -7,10 +7,6 @@
 
   "src/electron/patches/node": "src/third_party/electron_node",
 
-  "src/electron/patches/squirrel.mac": "src/third_party/squirrel.mac",
-
-  "src/electron/patches/ReactiveObjC": "src/third_party/squirrel.mac/vendor/ReactiveObjC",
-
   "src/electron/patches/depot_tools": "src/third_party/depot_tools",
 
   "src/electron/patches/sqlite": "src/third_party/sqlite/src",
diff --git a/patches/node/fix_add_default_values_for_enable_lto_and_build_v8_with_gn_in.patch b/patches/node/fix_add_default_values_for_enable_lto_and_build_v8_with_gn_in.patch
index 02aa362935..f7ce72cd7e 100644
--- a/patches/node/fix_add_default_values_for_enable_lto_and_build_v8_with_gn_in.patch
+++ b/patches/node/fix_add_default_values_for_enable_lto_and_build_v8_with_gn_in.patch
@@ -11,7 +11,7 @@ diff --git a/common.gypi b/common.gypi
 index cebf2121ff913080ab0771f6c4dfa35ce6812bc0..df69aecc74ef66b9501d4bed0e1311e7cda2d5b8 100644
 --- a/common.gypi
 +++ b/common.gypi
-@@ -73,6 +73,22 @@
+@@ -73,6 +73,23 @@
  
      ##### end V8 defaults #####
  
@@ -30,6 +30,7 @@ index cebf2121ff913080ab0771f6c4dfa35ce6812bc0..df69aecc74ef66b9501d4bed0e1311e7
 +    # these values being accurate.
 +    'build_v8_with_gn': 'false',
 +    'enable_lto%': 'false',
++    'openssl_fips': '',
 +
      'conditions': [
        ['target_arch=="arm64"', {
diff --git a/patches/v8/cherry-pick-36abafa0a316.patch b/patches/v8/cherry-pick-36abafa0a316.patch
index cf9b3e9822..a123659e4e 100644
--- a/patches/v8/cherry-pick-36abafa0a316.patch
+++ b/patches/v8/cherry-pick-36abafa0a316.patch
@@ -48,24 +48,6 @@ index b34076025f07ff5b4fadb8800c44acefa5480d19..d9abe45124f176d9ea7ab931a8247fbb
 +        MessageTemplate::kDataCloneErrorNonDetachableArrayBuffer);
 +    return Nothing<bool>();
 +  }
- 
+
    uint32_t* transfer_entry = array_buffer_transfer_map_.Find(array_buffer);
    if (transfer_entry) {
-diff --git a/test/mjsunit/wasm/worker-memory.js b/test/mjsunit/wasm/worker-memory.js
-index c5b99ede7e28364bbbe31165dfd8b8449a718137..bf5430f7139815c229e641eb6d40725b066035c5 100644
---- a/test/mjsunit/wasm/worker-memory.js
-+++ b/test/mjsunit/wasm/worker-memory.js
-@@ -11,6 +11,13 @@
-   assertThrows(() => worker.postMessage(memory), Error);
- })();
- 
-+(function TestPostMessageUnsharedMemoryBuffer() {
-+  let worker = new Worker('', {type: 'string'});
-+  let memory = new WebAssembly.Memory({initial: 1, maximum: 2});
-+
-+  assertThrows(() => worker.postMessage(memory.buffer), Error);
-+})();
-+
- // Can't use assert in a worker.
- let workerHelpers =
-   `function assertTrue(value, msg) {
diff --git a/patches/v8/merged_deoptimizer_stricter_checks_during_deoptimization.patch b/patches/v8/merged_deoptimizer_stricter_checks_during_deoptimization.patch
index 49ce81c6bd..db5a37dfe4 100644
--- a/patches/v8/merged_deoptimizer_stricter_checks_during_deoptimization.patch
+++ b/patches/v8/merged_deoptimizer_stricter_checks_during_deoptimization.patch
@@ -31,39 +31,3 @@ index c2b4d402eedc417f49137a1a670e08042f643d4e..a225bac2b73f3fe61e611aaca19c1293
            // Replace the current pc on the stack with the trampoline.
            // TODO(v8:10026): avoid replacing a signed pointer.
            Address* pc_addr = it.frame()->pc_address();
-diff --git a/test/mjsunit/mjsunit.status b/test/mjsunit/mjsunit.status
-index b95bc697604b983a4d48a0899776290bbe3720bf..277b48fc66c4024d9bea8c8dc1e6c2e36669f55c 100644
---- a/test/mjsunit/mjsunit.status
-+++ b/test/mjsunit/mjsunit.status
-@@ -81,6 +81,10 @@
-   # https://crbug.com/1129854
-   'tools/log': ['arch == arm or arch == arm64', SKIP],
- 
-+  # crbug.com/1161357
-+  # TODO(solanes): Remove this entry once the underlying issue is fixed.
-+  'regress/regress-1161357': [PASS, FAIL],
-+
-   ##############################################################################
-   # Tests where variants make no sense.
-   'd8/enable-tracing': [PASS, NO_VARIANTS],
-diff --git a/test/mjsunit/regress/regress-1161357.js b/test/mjsunit/regress/regress-1161357.js
-new file mode 100644
-index 0000000000000000000000000000000000000000..b6f03b92ac970f1f24c8e6aa03b27e849d2ae7bc
---- /dev/null
-+++ b/test/mjsunit/regress/regress-1161357.js
-@@ -0,0 +1,15 @@
-+// Copyright 2020 the V8 project authors. All rights reserved.
-+// Use of this source code is governed by a BSD-style license that can be
-+// found in the LICENSE file.
-+
-+for (let i = 0; i < 3; i++) {
-+  for (let j = 0; j < 32767; j++) {
-+    Number;
-+  }
-+  for (let j = 0; j < 2335; j++) {
-+    Number;
-+  }
-+  var arr = [, ...(new Int16Array(0xffff)), 4294967296];
-+  arr.concat(Number, arr)
-+}
-+eval(``);
-- 
2.26.2

